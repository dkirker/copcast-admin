<div class="container">
  <h2 translate>Use Report</h2>
  <hr class="hrDarker"/>
  <div class="alert alert-danger" role="alert" ng-show="errorMessage">
    {{errorMessage}}
  </div>
  <div class="panel">
    <div class="panel-title" translate>Filter</div>
    <div class="panel-body">
      <form novalidate="novalidate" class="form-inline date filter">
        <div class="form-group">
          <label translate>From</label>

          <input type="date" datepicker-options="{customClass: 'datepicker-filter'}" class="form-control"
                 ng-model="filter.fromDate" ng-model-options="{ debounce: 500 }"
                 uib-datepicker-popup is-open="filter.fromDateVisible"
                 ng-required="true" show-button-bar="false" show-weeks="false"
                 ng-click="filter.fromDateShow()"/>
          <i class="icon calendar"></i>
        </div>
        <div class="form-group">
          &nbsp;&nbsp;&nbsp;<label translate>To</label>

            <input type="date" datepicker-options="{customClass: 'datepicker-filter'}" class="form-control"
                   ng-model="filter.toDate" ng-model-options="{ debounce: 500 }"
                   uib-datepicker-popup is-open="filter.toDateVisible"
                   ng-required="true" show-button-bar="false" show-weeks="false"
                   ng-click="filter.toDateShow()"/>
            <i class="icon calendar"></i>
        </div>
        <div class="form-group">
          &nbsp;&nbsp;&nbsp;<a ng-click="updateFilter()" class="btn btn-small btn-primary" translate>Update</a>
        </div>

      </form>
    </div>
  </div>
  <div ng-show="hasData()">
    <h3 translate>Use of Copcast - Report from {{filter.fromDate  | date:"dd/MM/yyyy"}} to {{filter.toDate  | date:"dd/MM/yyyy"}}</h3>

    <div class="row">
      <div class="col-md-4" translate><strong>Active officers users</strong></div>
      <div class="col-md-4">{{reportData.activeOfficers}}</div>
    </div>
    <!--<div class="row">-->
      <!--<div class="col-md-4" translate><strong>Number of missions initiated (missions greater than 30 minutes)</strong>-->
      <!--</div>-->
      <!--<div class="col-md-4">{{reportData.missions}}</div>-->
    <!--</div>-->
    <div class="row">
      <div class="col-md-4" translate><strong>Number of hours of recorded footage</strong></div>
      <div class="col-md-4">{{reportData.recordedTime | minutesToHours}}</div>
    </div>
    <div class="row">
      <div class="col-md-4" translate><strong>Number of hours of streamed footage</strong></div>
      <div class="col-md-4">{{reportData.streamedTime | minutesToHours }}</div>
    </div>
    <div class="row">
      <div class="col-md-4" translate><strong>Number of flagged incidents</strong></div>
      <div class="col-md-4">{{reportData.incidents}}</div>
    </div>
    <div class="row">
      <div class="col-md-4" translate><strong>Number of personnel accessing the admin system</strong></div>
      <div class="col-md-4">{{reportData.adminAccess}}</div>
    </div>
    <hr/>
    <div ng-show="reportData.exportList && reportData.exportList.length > 0">
      <h4 translate><strong>Exported videos</strong></h4>

      <div class="row">
        <div class="col-md-8">
          <table class="table table-condensed table-hover">
            <thead>
            <tr>
              <th translate>User</th>
              <th translate>Export date</th>
              <th translate>Recording Date</th>
              <th translate>Exporter</th>
              <th translate>Status</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="export in reportData.exportList">
              <td>{{export.Recorder.name }}</td>
              <td>{{export.createdAt | date : 'yyyy-MM-dd HH:mm'}}</td>
              <td>{{export.initialDate  | date : 'yyyy-MM-dd'}}</td>
              <td>{{export.Exporter.name}}</td>
              <td>{{export.status}}</td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="row" ng-show="reportData.playedVideos.length > 0 ">
      <h4 translate><strong>Videos viewed</strong></h4>
      <table class="table table-condensed table-hover" >
        <tr>
          <th translate>Video URL</th>
          <th translate>Played at</th>
          <th translate>Started Time</th>
          <th translate>Who watched it</th>
          <th translate>Who recorded it</th>
        </tr>
        <tr ng-repeat="videoData in reportData.playedVideos">
          <td>{{videoData.url}}</td>
          <td>{{videoData.date | date:'dd/MM/yyyy HH:mm'}}</td>
          <td>{{videoData.startTime}} s</td>
          <td>{{videoData.userName}}</td>
          <td>{{videoData.userRecorderName}}</td>
        </tr>
      </table>
    </div>
    <hr/>
    <div>
      <h4 translate>Information by user<br/>
        <small translate>grouped by day</small>
      </h4>
      <table class="table table-condensed table-hover" ng-repeat="user in reportData.users">
        <caption>{{user.username}}</caption>
        <tr>
          <th translate>Day</th>
          <th translate>Number of times mission was stopped</th>
          <th translate>Incidents Reported</th>
          <th translate>Total time recording</th>
          <th translate>Total time streaming</th>
          <th translate>Total time paused</th>
          <th translate>Total data uploaded</th>
          <th translate>Total</th>
        </tr>
        <tr ng-repeat="activity in user.activities">
          <td>{{activity.date |  date:'dd/MM/yyyy'}}</td>
          <td>{{activity.totalMissions}}</td>
          <td>{{activity.incidents}}</td>
          <td>{{activity.recordedTime | minutesToHours}}</td>
          <td>{{activity.streamedTime | minutesToHours}}</td>
          <td>{{activity.pausedTime | minutesToHours}}</td>
          <td>{{activity.filesize | bytes}}</td>
          <td><strong>{{activity | totalAndMinutesToHours}}</strong></td>
        </tr>
      </table>
    </div>
    <br/>

    <div>
      <h4 translate>Number of traffic incidents reported</h4>

      <div class="row">
        <div class="col-md-4">
          <table class="table table-condensed table-hover">
            <tr>
              <th translate>Gravity</th>
            </tr>
            <tr>
              <th>1</th>
              <td>{{reportData.incidentReport[0]}}</td>
            </tr>
            <tr>
              <th>2</th>
              <td>{{reportData.incidentReport[1]}}</td>
            </tr>
            <tr>
              <th>3</th>
              <td>{{reportData.incidentReport[2]}}</td>
            </tr>
            <tr>
              <th>4</th>
              <td>{{reportData.incidentReport[3]}}</td>
            </tr>
            <tr>
              <th>5</th>
              <td>{{reportData.incidentReport[4]}}</td>
            </tr>
          </table>
        </div>
      </div>
    </div>

  </div>

  <div ng-hide="hasData()" class="jumbotron text-center">
    <h3 translate>No data selected</h3>

    <p translate>
      select a period to present related data.
    </p>
  </div>
</div>
